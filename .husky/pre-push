#!/bin/sh

echo "Running pre-push checks..."

# Type check (frontend + server in parallel)
echo "Running type checks..."
npm run type-check &
PID_FE=$!
(cd server && npm run type-check) &
PID_BE=$!

wait $PID_FE || exit 1
wait $PID_BE || exit 1

# Unit tests (frontend only â€” server tests have pre-existing unhandled
# rejections in backfill scripts that cause vitest to exit non-zero
# even when all tests pass; run server tests manually or rely on CI)
echo "Running tests..."
npm test || exit 1

echo "All pre-push checks passed!"
